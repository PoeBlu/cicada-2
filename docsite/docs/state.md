---
id: state
title: State
sidebar_label: State
---

The Cicada state container is essentially a giant dictionary that gets tracks
information generated in each test.

## Structure

The state container follows this structure:

<pre><code>
{
    test-name: {
        actions: {
            action-name: {
                results: [
                    {dictionary generated by runner}
                ],
                outputs: {
                    output-name: {value specified in test config}
                }
            },
            another-action-name: {...}
        },
        asserts: {
            assert-name: [
                {
                    <a href="actionsasserts#assert-result">AssertResult</a>
                }
            ],
            another-action-name: [...]
        }
    }
    another-test-name: {
        ...
    }
}
</code></pre>

> Notice that the test-generated data is stored in lists. This can be changed
> to produce a single result (and overwrite the previous result) by setting
> the `storeVersions` parameter in actions, outputs, and asserts to `false`

## Templates

The state container can be used in tests through a parameter called `templates`.
The templates section will be rendered using Jinja2 and replaced into the config.

For example, let's say we wanted to make sure the API returns the Jeff that was created:

```yaml
- name: check-jeff-added
  description: Checks that API returns new Jeff
  dependencies:
    - add-member
  runner: rest-runner
  asserts:
    - type: JSON
      template: >
        params:
          method: GET
          actionParams:
            url: http://api:8080/members/{{ state['add-member']['actions']['POST0']['results'][0]['body']['id'] }}
          expected:
            name: Jeff
            age: 25
```

When the action is run, this template will be rendered and the template section
will be added to the assert config:

```yaml
- name: check-jeff-added
  description: Checks that API returns new Jeff
  dependencies:
    - add-member
  runner: sql-runner
  asserts:
    - type: JSON
      params:
        method: GET
        actionParams:
          url: http://api:8080/members/{{ state['add-member']['actions']['POST0']['results'][0]['body']['id'] }}
        expected:
          name: Jeff
          age: 25
```
